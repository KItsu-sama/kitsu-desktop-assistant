kitsu/
â”‚
â”œâ”€â”€ main.pyÂ  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  # ğŸš€ Entry point - minimal, just bootstraps
â”œâ”€â”€ launcher.pyÂ  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  # ğŸ¬ Handles initialization, config loading
â”œâ”€â”€ requirements.txtÂ  Â  Â  Â  Â  Â  Â  Â  Â # ğŸ“¦ Python dependencies
â”œâ”€â”€ pyproject.tomlÂ  Â  Â  Â  Â  Â  Â  Â  Â  Â # ğŸ”§ Modern Python project config
â”œâ”€â”€ README.mdÂ  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  # ğŸ“– User-facing documentation
â”œâ”€â”€ CONTRIBUTING.mdÂ  Â  Â  Â  Â  Â  Â  Â  Â  # ğŸ¤ For community contributors
â”œâ”€â”€ .env.exampleÂ  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â # ğŸ” Template for secrets
â”‚
â”œâ”€â”€ /core/                                   # ğŸ§  Kitsu's Brain (Pure Logic)
â”‚Â  Â â”œâ”€â”€ __init__.py
â”‚Â  Â â”œâ”€â”€  kitsu_core.py                         # Orchestrator: routes input â†’ NLP / emotion / intent  â†’  META-CONTROLLER  ğŸ‘‘  â†’   planner / memory / reflection (conditional)  â†’  LLM
â”‚Â  Â â”œâ”€â”€  fallback_manager.py                   # Safety fallback responses
â”‚Â  Â â”‚
â”‚Â  Â â”‚   # ğŸ›  DEV-ONLY TOOLS (not for user)  
â”‚Â  Â â”‚ #=============================================================#=============================================================#
â”‚Â  Â â”‚
â”‚   â”œâ”€â”€ /response_manager/           # Dev tools for response tuning
â”‚   â”‚   â”œâ”€â”€ history.py
â”‚   â”‚   â”œâ”€â”€ overrides.py
â”‚   â”‚   â””â”€â”€ exporter.py
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ dev/                     # ğŸ›  ALL dev tools here
â”‚   â”‚   â”œâ”€â”€ console_router.py        
â”‚   â”‚   â”œâ”€â”€ permissions.py           
â”‚   â”‚   â””â”€â”€ ğŸ“ handlers/
â”‚   â”‚       â”œâ”€â”€ command_registry.py      # Command registration
â”‚   â”‚       â”œâ”€â”€ response_trainer.py  
â”‚   â”‚       â”œâ”€â”€ response_rater.py    
â”‚   â”‚       â”œâ”€â”€ error_viewer.py      
â”‚   â”‚       â”œâ”€â”€ stats_viewer.py      
â”‚   â”‚       â”œâ”€â”€ module_resetter.py   
â”‚   â”‚       â””â”€â”€ debug_tools.py       
â”‚   â”‚
â”‚Â  Â â”‚ #=============================================================#=============================================================#
â”‚Â  Â â”‚
â”‚Â  Â â”œâ”€â”€/onboarding/                          # ğŸ‰ First-time experience
â”‚Â  Â â”‚   â”œâ”€â”€ __init__.py
â”‚Â  Â â”‚   â”œâ”€â”€ onboarding_flow.py                # Full onboarding logic
â”‚Â  Â â”‚   â”œâ”€â”€ onboarding_ascii.py               # ASCII onboarding UI
â”‚Â  Â â”‚   â”œâ”€â”€ onboarding_voice.py               # TTS version of onboarding
â”‚Â  Â â”‚   â””â”€â”€ help_panel.py                     # Scrollable categorized help menu
â”‚Â  Â â”‚
â”‚Â  Â â”‚
â”‚Â  Â â”œâ”€â”€ /personality/                         # ğŸ¦Š Identity & Personality Engine
â”‚Â  Â â”‚   â”œâ”€â”€ __init__.py
â”‚Â  Â â”‚   â”œâ”€â”€ self_model.py
â”‚Â  Â â”‚   â”œâ”€â”€ emotion_engine.py
â”‚Â  Â â”‚   â”œâ”€â”€ mood_tracker.py
â”‚Â  Â â”‚   â”œâ”€â”€ behavior_modes.py
â”‚Â  Â â”‚   â”œâ”€â”€ kitsu_self.py
â”‚Â  Â â”‚   â”œâ”€â”€ trigger_manager.py
â”‚Â  Â â”‚   â”œâ”€â”€ triggers.py
â”‚Â  Â â”‚   â””â”€â”€ sass_generator.py
â”‚Â  Â â”‚
â”‚Â  Â â”‚
â”‚Â  Â â”œâ”€â”€ /cognition/                           # ğŸ¤” Thought Processing
â”‚Â  Â â”‚   â”œâ”€â”€ __init__.py
â”‚Â  Â â”‚   â”œâ”€â”€ planner.py
â”‚Â  Â â”‚   â”œâ”€â”€ executor.py
â”‚Â  Â â”‚   â”œâ”€â”€ nlp_processor.py
â”‚Â  Â â”‚   â”œâ”€â”€ intent_classifier.py
â”‚Â  Â â”‚   â”œâ”€â”€ context_builder.py
â”‚Â  Â â”‚   â”‚
â”‚Â  Â â”‚   â””â”€â”€ /navigation/                      # ğŸ§­ Tool / Function Navigation
â”‚Â  Â â”‚       â”œâ”€â”€ __init__.py
â”‚Â  Â â”‚       â”œâ”€â”€ neuro_navigation.py
â”‚Â  Â â”‚       â”œâ”€â”€ tool_registry.py
â”‚Â  Â â”‚       â”œâ”€â”€ embedder.py
â”‚Â  Â â”‚       â””â”€â”€ adapters.py
â”‚Â  Â â”‚
â”‚Â  Â â”‚
â”‚Â  Â â”œâ”€â”€ /memory/                              # ğŸ’¾ Memory System
â”‚Â  Â â”‚   â”œâ”€â”€ __init__.py
â”‚Â  Â â”‚   â”œâ”€â”€ memory_manager.py
â”‚Â  Â â”‚   â”œâ”€â”€ short_term.py
â”‚Â  Â â”‚   â”œâ”€â”€ episodic.py
â”‚Â  Â â”‚   â”œâ”€â”€ sleep_compressor.py
â”‚Â  Â â”‚   â”œâ”€â”€ user_manager.py
â”‚Â  Â â”‚   â”œâ”€â”€ scoring.py
â”‚Â  Â â”‚   â””â”€â”€ retrieval.py
â”‚Â  Â â”‚
â”‚Â  Â â”œâ”€â”€ /meta/
â”‚Â  Â â”‚   â”œâ”€â”€ __init__.py
â”‚Â  Â â”‚   â”œâ”€â”€ meta_controller.py      # ğŸ‘‘ The brain that decides modes
â”‚Â  Â â”‚   â”œâ”€â”€ decision_models.py      # Heuristics / scoring logic
â”‚Â  Â â”‚   â”œâ”€â”€ response_modes.py       # Mode definitions
â”‚Â  Â â”‚   â”œâ”€â”€ safety_gate.py          # Hard limits & filtering
â”‚Â  Â â”‚
â”‚Â  Â â”‚
â”‚Â  Â â”œâ”€â”€ /learning/                            # ğŸ“š Online Learning System
â”‚Â  Â â”‚   â”œâ”€â”€ __init__.py
â”‚Â  Â â”‚   â”œâ”€â”€ state_encoder.py
â”‚Â  Â â”‚   â”œâ”€â”€ online_rl.py
â”‚Â  Â â”‚   â”œâ”€â”€ reward_engine.py
â”‚Â  Â â”‚   â”œâ”€â”€ preference_learner.py
â”‚Â  Â â”‚   â””â”€â”€ trainer.py
â”‚Â  Â â”‚
â”‚Â  Â â”‚
â”‚Â  Â â”œâ”€â”€ /events/                              # ğŸ“¡ Event System
â”‚Â  Â â”‚   â”œâ”€â”€ __init__.py
â”‚Â  Â â”‚   â”œâ”€â”€ event_manager.py
â”‚Â  Â â”‚   â”œâ”€â”€ trigger_system.py
â”‚Â  Â â”‚   â”œâ”€â”€ reaction_registry.py
â”‚Â  Â â”‚   â””â”€â”€ cooldown_manager.py
â”‚Â  Â â”‚
â”‚Â  Â â”‚
â”‚   â””â”€â”€ /llm/                                 # ğŸ¤– LLM Integration
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ __init__.py
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ llm_interface.py
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ lora_manager.py
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ ollama_adapter.py
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ api_adapter.py
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ prompt_builder.py 
â”‚
â”œâ”€â”€ /io_layer/Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â # ğŸ¤ğŸ”Š Input/Output Layer  (currently empty)
â”‚Â  Â â”œâ”€â”€ init.py
â”‚Â  Â â”œâ”€â”€ io_manager.pyÂ  Â  Â  Â  Â  Â  Â  Â  # Coordinates all I/O
â”‚Â  Â â”‚
â”‚Â  Â â”œâ”€â”€ /voice/Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  # ğŸ™ï¸ Voice I/O
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ init.py
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ voice_input.pyÂ  Â  Â  Â  Â  Â # STT (speech-to-text)
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ voice_output.pyÂ  Â  Â  Â  Â  # TTS (text-to-speech)
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ voice_changer.pyÂ  Â  Â  Â  Â # Emotion-based voice modulation
â”‚Â  Â â”‚Â  Â â””â”€â”€ audio_processor.pyÂ  Â  Â  Â # Audio utils
â”‚Â  Â â”‚
â”‚Â  Â â”œâ”€â”€ /avatar/Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â # ğŸ‘§ Avatar Display
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ init.py
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ avatar_controller.pyÂ  Â  Â # Main avatar coordinator
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ animator.pyÂ  Â  Â  Â  Â  Â  Â  # Expression animations
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ live2d_renderer.pyÂ  Â  Â  Â # Live2D support
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ vrm_renderer.pyÂ  Â  Â  Â  Â  # VRM 3D support
â”‚Â  Â â”‚Â  Â â””â”€â”€ sprite_renderer.pyÂ  Â  Â  Â # 2D sprite fallback
â”‚Â  Â â”‚
â”‚Â  Â â”œâ”€â”€ /chat/Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â # ğŸ’¬ Text Interface
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ init.py
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ chat_interface.pyÂ  Â  Â  Â  # Text I/O (terminal/GUI)
â”‚Â  Â â”‚Â  Â â””â”€â”€ formatter.pyÂ  Â  Â  Â  Â  Â  Â # Pretty-print messages
â”‚Â  Â â”‚
â”‚Â  Â â””â”€â”€ /desktop/Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  # ğŸ–¥ï¸ Desktop Integration
â”‚Â  Â  Â  Â â”œâ”€â”€ init.py
â”‚Â  Â  Â  Â â”œâ”€â”€ window_manager.pyÂ  Â  Â  Â  # Desktop window control
â”‚Â  Â  Â  Â â”œâ”€â”€ interaction_zones.pyÂ  Â  Â # Click/hover areas
â”‚Â  Â  Â  Â â””â”€â”€ overlay_renderer.pyÂ  Â  Â  # Transparent overlays
â”‚
â”œâ”€â”€ /integrations/Â  Â  Â  Â  Â  Â  Â  Â  Â  Â # ğŸ”Œ External System Hooks (currently empty)
â”‚Â  Â â”œâ”€â”€ init.py
â”‚Â  Â â”œâ”€â”€ integration_manager.pyÂ  Â  Â  Â # Plugin manager for integrations
â”‚Â  Â â”‚
â”‚Â  Â â”œâ”€â”€ /browser/Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  # ğŸŒ Browser Integration
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ init.py
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ history_reader.pyÂ  Â  Â  Â  # Read browser history
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ youtube_watcher.pyÂ  Â  Â  Â # Track YouTube activity
â”‚Â  Â â”‚Â  Â â””â”€â”€ content_reactor.pyÂ  Â  Â  Â # React to content
â”‚Â  Â â”‚
â”‚Â  Â â”œâ”€â”€ /system/Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â # âš™ï¸ OS Integration
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ init.py
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ system_monitor.pyÂ  Â  Â  Â  # CPU/RAM/disk monitoring
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ idle_detector.pyÂ  Â  Â  Â  Â # Detect user idle
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ app_controller.pyÂ  Â  Â  Â  # Block/control apps
â”‚Â  Â â”‚Â  Â â””â”€â”€ power_control.pyÂ  Â  Â  Â  Â # Shutdown/restart (with permission!)
â”‚Â  Â â”‚
â”‚Â  Â â”œâ”€â”€ /security/Â  Â  Â  Â  Â  Â  Â  Â  Â  Â # ğŸ›¡ï¸ Anti-Tamper
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ init.py
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ tamper_detector.pyÂ  Â  Â  Â # Detect reverse engineering
â”‚Â  Â â”‚Â  Â â””â”€â”€ integrity_checker.pyÂ  Â  Â # Verify code integrity
â”‚Â  Â â”‚
â”‚Â  Â â””â”€â”€ /plugins/Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  # ğŸ”§ Community Plugins
â”‚Â  Â  Â  Â â”œâ”€â”€ init.py
â”‚Â  Â  Â  Â â”œâ”€â”€ plugin_loader.pyÂ  Â  Â  Â  Â # Dynamic plugin loading
â”‚Â  Â  Â  Â â”œâ”€â”€ plugin_api.pyÂ  Â  Â  Â  Â  Â  # API for plugin developers
â”‚Â  Â  Â  Â â””â”€â”€ /installed/Â  Â  Â  Â  Â  Â  Â  # User-installed plugins
â”‚Â  Â  Â  Â  Â  Â â””â”€â”€ example_plugin/
â”‚
â”œâ”€â”€ /toybox/Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â # ğŸ® Interactive Toys  (currently empty)
â”‚Â  Â â”œâ”€â”€ init.py
â”‚Â  Â â”œâ”€â”€ toybox_manager.pyÂ  Â  Â  Â  Â  Â  # Toy registry and loader
â”‚Â  Â â”œâ”€â”€ toy_base.pyÂ  Â  Â  Â  Â  Â  Â  Â  Â  # Abstract base class for toys
â”‚Â  Â â”‚
â”‚Â  Â â”œâ”€â”€ /built_in_toys/Â  Â  Â  Â  Â  Â  Â  # ğŸ Included Toys
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ init.py
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ pet_rock.pyÂ  Â  Â  Â  Â  Â  Â  # The legendary pet rock
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ lava_lamp.pyÂ  Â  Â  Â  Â  Â  Â # Mesmerizing blobs
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ bubble_wrap.pyÂ  Â  Â  Â  Â  Â # Satisfying pops
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ pong_game.pyÂ  Â  Â  Â  Â  Â  Â # AI Pong with learning
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ fox_run.pyÂ  Â  Â  Â  Â  Â  Â  Â # Endless runner
â”‚Â  Â â”‚Â  Â â””â”€â”€ fidget_spinner.pyÂ  Â  Â  Â  # Virtual spinner
â”‚Â  Â â”‚
â”‚Â  Â â”œâ”€â”€ /community_toys/Â  Â  Â  Â  Â  Â  Â # ğŸ“¦ User-Downloaded Toys
â”‚Â  Â â”‚Â  Â â””â”€â”€ .gitkeep
â”‚Â  Â â”‚
â”‚Â  Â â””â”€â”€ /toy_api/Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  # ğŸ› ï¸ Toy Development Kit
â”‚Â  Â  Â  Â â”œâ”€â”€ init.py
â”‚Â  Â  Â  Â â”œâ”€â”€ toy_interface.pyÂ  Â  Â  Â  Â # Standard toy interface
â”‚Â  Â  Â  Â â”œâ”€â”€ rendering.pyÂ  Â  Â  Â  Â  Â  Â # Rendering helpers
â”‚Â  Â  Â  Â â”œâ”€â”€ physics.pyÂ  Â  Â  Â  Â  Â  Â  Â # Simple physics engine
â”‚Â  Â  Â  Â â””â”€â”€ kitsu_interactions.pyÂ  Â  # How toys trigger Kitsu reactions
â”‚
â”œâ”€â”€ /ui/Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â # ğŸ¨ User Interface  (mostly empty)
â”‚Â  Â â”œâ”€â”€ init.py
â”‚Â  Â â”œâ”€â”€ ui_manager.pyÂ  Â  Â  Â  Â  Â  Â  Â  # UI coordinator
â”‚Â  Â â”‚
â”‚Â  Â â”œâ”€â”€ /console/
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ __init__.py
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ ascii_ui.py              # Rich-based UI rendering
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ help_system.py           # Full categorized help manager
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ onboarding.py            # First-run onboarding flow
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ kitsu_speaker.py         # Handles TTS/text-based speech output
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ onboarding_display.py
â”‚Â  Â â”‚Â  Â â””â”€â”€ ui_config.py             # Mode toggles + appearance
â”‚Â  Â â”‚
â”‚Â  Â â”œâ”€â”€ /desktop_ui/Â  Â  Â  Â  Â  Â  Â  Â  Â # ğŸªŸ Desktop Interface
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ main_window.pyÂ  Â  Â  Â  Â  Â # Main Kitsu window
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ settings_panel.pyÂ  Â  Â  Â  # Configuration UI
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ toybox_viewer.pyÂ  Â  Â  Â  Â # Browse toys
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ appearance.py
â”‚Â  Â â”‚Â  Â â””â”€â”€ notification_s ystem.pyÂ  Â # Popup notifications
â”‚Â  Â â”‚
â”‚Â  Â â”œâ”€â”€ /overlays/Â  Â  Â  Â  Â  Â  Â  Â  Â  Â # ğŸ­ Floating Overlays
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ init.py
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ emotion_overlay.pyÂ  Â  Â  Â # Show current emotion
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ thought_bubble.pyÂ  Â  Â  Â  # Display thoughts
â”‚Â  Â â”‚Â  Â â””â”€â”€ tooltip_system.pyÂ  Â  Â  Â  # Hover tooltips
â”‚Â  Â â”‚
â”‚Â  Â â””â”€â”€ /pranks/Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â # ğŸ˜ˆ Prank UI
â”‚Â  Â  Â  Â â”œâ”€â”€ init.py
â”‚Â  Â  Â  Â â”œâ”€â”€ fake_errors.pyÂ  Â  Â  Â  Â  Â # Fake error windows
â”‚Â  Â  Â  Â â”œâ”€â”€ window_shuffler.pyÂ  Â  Â  Â # Rearrange windows
â”‚Â  Â  Â  Â â””â”€â”€ cursor_games.pyÂ  Â  Â  Â  Â  # Mess with cursor
â”‚
â”œâ”€â”€ /marketplace/Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  # ğŸ›’ Community Marketplace (currently empty)
â”‚Â  Â â”œâ”€â”€ init.py
â”‚Â  Â â”œâ”€â”€ marketplace_client.pyÂ  Â  Â  Â  # Browse/download content
â”‚Â  Â â”œâ”€â”€ package_manager.pyÂ  Â  Â  Â  Â  Â # Install/update packages
â”‚Â  Â â”œâ”€â”€ rating_system.pyÂ  Â  Â  Â  Â  Â  Â # Rate community content
â”‚Â  Â â””â”€â”€ upload_tool.pyÂ  Â  Â  Â  Â  Â  Â  Â # Upload creations
â”‚
â”œâ”€â”€ /assets/Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â # ğŸ¨ Resources   (currently empty)
â”‚Â  Â â”œâ”€â”€ /models/Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â # Avatar Models
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ /kitsu/
â”‚Â  Â â”‚Â  Â â”‚Â  Â â”œâ”€â”€ /full/Â  Â  Â  Â  Â  Â  Â  Â # VRM/Live2D full models
â”‚Â  Â â”‚Â  Â â”‚Â  Â â”‚Â  Â â”œâ”€â”€ 
â”‚Â  Â â”‚Â  Â â”‚Â  Â â”‚Â  Â â”œâ”€â”€ default.vrm
â”‚Â  Â â”‚Â  Â â”‚Â  Â â”‚Â  Â â”œâ”€â”€ bunny_suit.vrm
â”‚Â  Â â”‚Â  Â â”‚Â  Â â”‚Â  Â â”œâ”€â”€ pajama.vrm
â”‚Â  Â â”‚Â  Â â”‚Â  Â â”‚Â  Â â””â”€â”€ ...
â”‚Â  Â â”‚Â  Â â”‚Â  Â â”œâ”€â”€ /chibi/Â  Â  Â  Â  Â  Â  Â  # Chibi sprites
â”‚Â  Â â”‚Â  Â â”‚Â  Â â”‚Â  Â â”œâ”€â”€ /default/
â”‚Â  Â â”‚Â  Â â”‚Â  Â â”‚Â  Â â”‚Â  Â â”œâ”€â”€ idle.png
â”‚Â  Â â”‚Â  Â â”‚Â  Â â”‚Â  Â â”‚Â  Â â”œâ”€â”€ happy.png
â”‚Â  Â â”‚Â  Â â”‚Â  Â â”‚Â  Â â”‚Â  Â â”œâ”€â”€ angry.png
â”‚Â  Â â”‚Â  Â â”‚Â  Â â”‚Â  Â â”‚Â  Â â”œâ”€â”€ embarrassed.png
â”‚Â  Â â”‚Â  Â â”‚Â  Â â”‚Â  Â â”‚Â  Â â””â”€â”€ ...
â”‚Â  Â â”‚Â  Â â”‚Â  Â â”‚Â  Â â””â”€â”€ /outfits/
â”‚Â  Â â”‚Â  Â â”‚Â  Â â””â”€â”€ /pixel/Â  Â  Â  Â  Â  Â  Â  # Pixel art for games
â”‚Â  Â â”‚Â  Â â”‚Â  Â  Â  Â â”œâ”€â”€ run.png
â”‚Â  Â â”‚Â  Â â”‚Â  Â  Â  Â â”œâ”€â”€ jump.png
â”‚Â  Â â”‚Â  Â â”‚Â  Â  Â  Â â”œâ”€â”€ idle.png
â”‚Â  Â â”‚Â  Â â”‚Â  Â  Â  Â â””â”€â”€ ...
â”‚Â  Â â”‚Â  Â â””â”€â”€ /community/Â  Â  Â  Â  Â  Â  Â  # User-uploaded models
â”‚Â  Â â”‚
â”‚Â  Â â”œâ”€â”€ /sounds/Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â # ğŸ”Š Audio
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ /voice/Â  Â  Â  Â  Â  Â  Â  Â  Â  # Voice clips
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ /sfx/Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  # Sound effects
â”‚Â  Â â”‚Â  Â â”‚Â  Â â”œâ”€â”€ giggles.wav
â”‚Â  Â â”‚Â  Â â”‚Â  Â â”œâ”€â”€ annoyed_sigh.wav
â”‚Â  Â â”‚Â  Â â”‚Â  Â â””â”€â”€ prank_sounds/
â”‚Â  Â â”‚Â  Â â””â”€â”€ /music/Â  Â  Â  Â  Â  Â  Â  Â  Â  # Background music
â”‚Â  Â â”‚
â”‚Â  Â â”œâ”€â”€ /ui_elements/Â  Â  Â  Â  Â  Â  Â  Â  # ğŸ¨ UI Assets
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ /icons/
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ /backgrounds/
â”‚Â  Â â”‚Â  Â â””â”€â”€ /effects/
â”‚Â  Â â”‚
â”‚Â  Â â””â”€â”€ /toybox_assets/Â  Â  Â  Â  Â  Â  Â  # ğŸ® Toy Resources
â”‚Â  Â  Â  Â â”œâ”€â”€ hand_open.png
â”‚Â  Â  Â  Â â”œâ”€â”€ hand_closed.png
â”‚Â  Â  Â  Â â””â”€â”€ /toy_specific/
â”‚
â”œâ”€â”€ /data/                                 # ğŸ’¾ Persistent Data (never touched by code directly)
â”‚  â”œâ”€â”€ /memory/                           # Short, episodic, compressed
â”‚  â”‚   â”œâ”€â”€ short_term.json                # Last messages, context window
â”‚  â”‚   â”œâ”€â”€ episodic.json                  # Significant events / milestones
â”‚  â”‚   â”œâ”€â”€ kitsu_state.json          # Current state snapshot
â”‚  â”‚   â”œâ”€â”€ checkpoints.jsonl
â”‚  â”‚   â”œâ”€â”€ memory.json
â”‚  â”‚   â”œâ”€â”€ memory.jsonl
â”‚  â”‚   â”œâ”€â”€ compressed/                    # Old archived memory chunks
â”‚  â”‚   â”‚   â””â”€â”€ .gitkeep
â”‚  â”‚   â””â”€â”€ backups/                       # Auto-saves & crash recovery
â”‚  â”‚       â””â”€â”€ .gitkeep
â”‚  â”‚
â”‚  â”œâ”€â”€ /models/                           # ML/CV models
â”‚  â”‚   â”œâ”€â”€ kitsu-lora-core
â”‚  â”‚   â”œâ”€â”€ kitsu-merged
â”‚  â”‚   â”œâ”€â”€ Modelfile.kitsu
â”‚  â”‚   â”œâ”€â”€ Modelfile.test
â”‚  â”‚   â”œâ”€â”€ emotion_classifier.onnx        #(currently hasnt been created yet)
â”‚  â”‚   â”œâ”€â”€ intent_classifier.onnx             #(currently hasnt been created yet)
â”‚  â”‚   â”œâ”€â”€ online_learning/                #(currently hasnt been created yet)
â”‚  â”‚   â”‚   â””â”€â”€ agent.pkl                  # RL policy   #(currently hasnt been created yet)
â”‚  â”‚   â””â”€â”€ preferences.pkl                # Learned user preferences    #(currently hasnt been created yet)
â”‚  â”‚
â”‚  â”œâ”€â”€ /config/                           # Everything the user can edit
â”‚  â”‚   â”œâ”€â”€ kitsu_config.json              # VTuber global settings (FPS, voice on/offâ€¦)
â”‚  â”‚   â”œâ”€â”€ personality.json               # Core personality coefficients
â”‚  â”‚   â”œâ”€â”€ triggers.json                  # Emotion triggers & multipliers
â”‚  â”‚   â”œâ”€â”€ permissions.json               # What Kitsu is allowed to control
â”‚  â”‚   â”œâ”€â”€ user_profile.json              # User profile (UI-friendly)
â”‚  â”‚
â”‚  â”œâ”€â”€ /templates/                        # Prompt templates & writing styles  
â”‚  â”‚   â”œâ”€â”€ base_personality.txt           # Foundation prompt  #(not in use currently)
â”‚  â”‚   â”œâ”€â”€ samples.txt                    # Example interactions   #(not in use currently)
â”‚  â”‚   â”œâ”€â”€ mode_templates/                 #(not in use currently)
â”‚  â”‚   â”‚   â”œâ”€â”€ behave.txt 
â”‚  â”‚   â”‚   â”œâ”€â”€ mean.txt
â”‚  â”‚   â”‚   â””â”€â”€ flirty.txt
â”‚  â”‚   â”œâ”€â”€ sass_base.json                 # Roast templates  #(not in use currently)
â”‚  â”‚   â””â”€â”€ reactions.json                 # (Optional) Emoji â†’ animation mapping  #(not in use currently)
â”‚  â”‚
â”‚  â”œâ”€â”€ /knowledge/
â”‚  â”‚   â”œâ”€â”€ facts.txt       â†’ Auto-tagged as neutral/behave/chaotic
â”‚  â”‚   â”œâ”€â”€ trivia.txt      â†’ Auto-tagged as playful/behave/chaotic
â”‚  â”‚   â”œâ”€â”€ technical.txt   â†’ Auto-tagged as helpful/behave/sweet
â”‚  â”‚   â”œâ”€â”€ science.txt     â†’ Auto-tagged as curious/behave/sweet
â”‚  â”‚   â”œâ”€â”€ history.txt     â†’ Auto-tagged as interested/behave/chaotic
â”‚  â”‚   â”œâ”€â”€ jokes.txt       â†’ Auto-tagged as funny/chaotic/gremlin
â”‚  â”‚   â””â”€â”€ stories.txt     â†’ Auto-tagged as creative/flirty/sweet
â”‚  â”‚
â”‚  â”‚
â”‚  â”œâ”€â”€ training/
â”‚  â”‚   â”œâ”€â”€  Auto_config.json  # Pipeline settings
â”‚  â”‚   â”œâ”€â”€  Auto/
â”‚  â”‚   â”‚   â”œâ”€â”€ combined_dataset.jsonl
â”‚  â”‚   â”‚   â””â”€â”€run_*.log
â”‚  â”‚
â”‚  â”‚
â”‚  â””â”€â”€ /logs/                             # Logs (rotating)
â”‚     â”œâ”€â”€ events.log
â”‚     â”œâ”€â”€ pranks.log
â”‚     â”œâ”€â”€ errors.log
â”‚     â””â”€â”€ analytics.log
â”‚ 
â”‚  â”œâ”€â”€ config.json
â”‚  â”œâ”€â”€ tmp_training.jsonl
â”‚  â””â”€â”€ triggers.json
â”‚
â”‚ 
â”œâ”€â”€ /utils/Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  # ğŸ”§ Utilities
â”‚Â  Â â”œâ”€â”€ init.py
â”‚Â  Â â”œâ”€â”€ logger.pyÂ  Â  Â  Â  Â  Â  Â  Â  Â  Â  # Logging system
â”‚Â  Â â”œâ”€â”€ config_loader.pyÂ  Â  Â  Â  Â  Â  Â # Load/save configs
â”‚Â  Â â”œâ”€â”€ randomizer.pyÂ  Â  Â  Â  Â  Â  Â  Â  # Controlled randomness
â”‚Â  Â â”œâ”€â”€ gpu_utils.pyÂ  Â  Â  Â  Â  Â  Â  Â  Â # GPU acceleration helpers
â”‚Â  Â â”œâ”€â”€ file_utils.pyÂ  Â  Â  Â  Â  Â  Â  Â  # File operations
â”‚Â  Â â”œâ”€â”€ time_utils.pyÂ  Â  Â  Â  Â  Â  Â  Â  # Time/scheduling helpers
â”‚Â  Â â””â”€â”€ validators.pyÂ  Â  Â  Â  Â  Â  Â  Â  # Input validation
â”‚
â”œâ”€â”€ /tests/Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  # âœ… Test Suite
â”‚Â  Â â”œâ”€â”€ init.py
â”‚Â  Â â”œâ”€â”€ /unit/Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â # Unit tests
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ test_emotion_engine.py
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ test_memory.py
â”‚Â  Â â”‚Â  Â â””â”€â”€ test_planner.py
â”‚Â  Â â”œâ”€â”€ /integration/Â  Â  Â  Â  Â  Â  Â  Â  # Integration tests
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ test_voice_pipeline.py
â”‚Â  Â â”‚Â  Â â””â”€â”€ test_toy_system.py
â”‚Â  Â â””â”€â”€ /fixtures/Â  Â  Â  Â  Â  Â  Â  Â  Â  Â # Test data
â”‚Â  Â  Â  Â â””â”€â”€ sample_conversations.json
â”‚
â”œâ”€â”€ ğŸ“ scripts/ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â # ğŸ› ï¸ Development Scripts
â”‚   â”œâ”€â”€ install_dependencies.py       
â”‚   â”œâ”€â”€ setup_wizard.py              
â”‚   â”œâ”€â”€ generate_dataset.py          
â”‚   â”œâ”€â”€ finetune_lora.py             
â”‚   â”œâ”€â”€ dataset_kitsu.py             
â”‚   â”œâ”€â”€ safety_filter.py             
â”‚   â”œâ”€â”€ run_kitsu.py                 # (for Ollama)
â”‚   â”œâ”€â”€ load_to_ollama_direct.py
â”‚   â”œâ”€â”€ train_all_styles.py
â”‚   â”œâ”€â”€ quick_start.sh               
â”‚Â  Â â”œâ”€â”€ quick_start.bat
â”‚Â  Â â”œâ”€â”€ convert_dataset.py
â”‚Â  Â â”œâ”€â”€ quick_add.py
â”‚Â  Â â”œâ”€â”€ quickstart_lora.py
â”‚Â  Â â”œâ”€â”€ load_to_ollama_direct
â”‚Â  Â â”œâ”€â”€ setup_dev.pyÂ  Â  Â  Â  Â  Â  Â  Â  Â # Development environment setup
â”‚Â  Â â”œâ”€â”€ train_models.pyÂ  Â  Â  Â  Â  Â  Â  # Train ML models
â”‚Â  Â â”œâ”€â”€ load_to_ollama_direct.py  Â  Â  Â  Â  Â # Load models into Ollama
â”‚Â  Â â”œâ”€â”€ generate_assets.pyÂ  Â  Â  Â  Â  Â # Asset generation helpers
â”‚Â  Â â”œâ”€â”€ package_for_release.pyÂ  Â  Â  Â # Build release packages
â”‚Â  Â â””â”€â”€ update_dependencies.pyÂ  Â  Â  Â # Update all deps
â”‚
â”œâ”€â”€ /docs/Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â # ğŸ“š Documentation
â”‚Â  Â â”œâ”€â”€ /api/Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  # API documentation
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ core_api.md
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ plugin_api.md
â”‚Â  Â â”‚Â  Â â””â”€â”€ toy_api.md
â”‚Â  Â â”œâ”€â”€ /guides/Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â # User guides
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ getting_started.md
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ customization.md
â”‚Â  Â â”‚Â  Â â””â”€â”€ plugin_development.md
â”‚Â  Â â”œâ”€â”€ /architecture/Â  Â  Â  Â  Â  Â  Â  Â # Architecture docs
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ system_overview.md
â”‚Â  Â â”‚Â  Â â”œâ”€â”€ emotion_system.md
â”‚Â  Â â”‚Â  Â â””â”€â”€ memory_system.md
â”‚Â  Â â””â”€â”€ /changelog/Â  Â  Â  Â  Â  Â  Â  Â  Â  # Version history
â”‚Â  Â  Â  Â â””â”€â”€ CHANGELOG.md
â”‚
â””â”€â”€ /external/Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â # ğŸŒ External Components (Optional)
â”œâ”€â”€ /csharp_ui/Â  Â  Â  Â  Â  Â  Â  Â  Â  # C# Desktop UI (if used)
â”‚Â  Â â”œâ”€â”€ KitsuUI.sln
â”‚Â  Â â”œâ”€â”€ /KitsuDesktop/
â”‚Â  Â â””â”€â”€ /ToyBox/
â””â”€â”€ /web_dashboard/Â  Â  Â  Â  Â  Â  Â  # Web-based control panel
â”œâ”€â”€ index.html
â”œâ”€â”€ /js/
â””â”€â”€ /css/


3 llm

(1) Emotion Classifier{intent, sentiment, triggers} # intent = intent of input , sentiment = how Kitsu think of it (+, none, -), triggers = any emotional triggers detected

{intent, sentiment, triggers} ==> mode


(2) mode + react Classifier ==> (plan, Expression, retaliation)

prompt =  f""" ...

{user} intent to {triggers}/{intent} by saying {input}

you intent to {intent} and {retaliation}

Mode == {mode}

... 

"""

(3) pmorpt + ResponseGenerator (response text)


planning = Planning(kitsu_self, memory, triggers, emotion_engine)

plan = planning.generate_plan("")

Primary Brain: Phi-3 Mini (1.8B SLM) - Fine-tuned for personality
â”œâ”€â”€ Vision: LLaVA-7B (VLM for webcam/screenshots)
â”œâ”€â”€ Memory: .... (LCM for long conversation history) (perfer free)
â”œâ”€â”€ Emotion Engine: Custom neural net (expression mapping)
â”œâ”€â”€ Voice: Real-time TTS with emotion modulation
â””â”€â”€ Idle Behavior: Procedural animation + mini-games

Modes:
â”œâ”€â”€ behave Mode: Phi-3 + gentle personality weights
â”œâ”€â”€ mean Mode: Phi-3 + sassy personality weights  
â””â”€â”€ flirty Mode: Phi-3 + flirty personality weights

Capabilities needed:
 Real-time emotional responses
 Visual awareness of user state
 Long-term relationship memory
 Fast, natural conversation (sub-100ms)
 Privacy-first local processing

 Emotion:

          Strong affection
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Flirty
   â”‚Â  Â â”‚                    â–²
Comfortâ”‚                â”‚Â  Â â”‚Tease / Playfight
       â–¼                â”‚Â  Â â”‚
Soft â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Gremlin Mean
 â–²                    â”‚Â  Â â”‚
 â”‚                    â”‚Â  Â â”‚ Strong insult / emotional hurt
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Cold â—„â”€â”€â”˜


        affection
   Soft â”€â”€â”€â–º Flirty
    â–²      â”‚Â  Â â”‚
â”‚Â  Â â”‚ comfort  â”‚ tease
â”‚Â  Â â”‚          â–¼
Silent â—„â”€â”€ Gremlin â—„â”€â”€ playfight/banter
   â–²           â”‚Â  Â â”‚
   â”‚           â”‚Â  Â â”‚ insult
   â”‚               â–¼
   Hide â—„â”€â”€â”€â”€â”€â”€ Cold
   (overwhelm)   (hurt)


Soft â†” Flirty â†” Gremlin
   â†‘         |       â†“
   |         | insult/hurt
   |         â†“
Silent â† Cold
   â†‘
   | overwhelm / fluster
   |
 Hide (turns off avatar / stops responding)

KITSU
 â”œâ”€â”€ Mood (Primary Personality Axis)
 â”‚    â”œâ”€â”€ behave
 â”‚    â”œâ”€â”€ mean
 â”‚    â””â”€â”€ flirty
 â”‚
 â””â”€â”€ Style (Expression / Flavor / Attitude Overlay)
      â”œâ”€â”€ chaotic
      â”œâ”€â”€ sweet
      â”œâ”€â”€ cold
      â””â”€â”€ silent (low-response mode)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    USER INPUT                           â”‚Â  Â â”‚
â”‚  "You're cute!" or "*boops nose*" or "You're stupid"    â”‚Â  Â â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   PLANNER                               â”‚Â  Â â”‚
â”‚  (Planning System)                                      â”‚Â  Â â”‚
â”‚                                                         â”‚Â  Â â”‚
â”‚  1. Save to memory (with emotion tag)                   â”‚Â  Â â”‚
â”‚  2. Check for triggers (keywords, symbols)              â”‚Â  Â â”‚
â”‚  3. Get current emotion + mood + style                  â”‚Â  Â â”‚
â”‚                                                         â”‚Â  Â â”‚
â”‚  IF TRIGGER FOUND:                                      â”‚Â  Â â”‚
â”‚    â†’ Fire trigger â†’ Update emotion stack                â”‚Â  Â â”‚
â”‚    â†’ Return ActionPlan (prank, tease, affection, etc.)  â”‚Â  Â â”‚
â”‚                                                         â”‚Â  Â â”‚
â”‚  ELSE (NORMAL DIALOGUE):                                â”‚Â  Â â”‚
â”‚    â†’ Generate with LLM (or sass fallback)               â”‚Â  Â â”‚ 
â”‚    â†’ Add voice pitch modulation                         â”‚Â  Â â”‚
â”‚    â†’ Return ActionPlan (dialogue)                       â”‚Â  Â â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             EMOTION ENGINE                              â”‚Â  Â â”‚
â”‚  (Stack System)                                         â”‚Â  Â â”‚
â”‚                                                         â”‚Â  Â â”‚
â”‚  Stack: [angry(0.9), offended(0.7), hurt(0.6)]          â”‚Â  Â â”‚
â”‚  Dominant: angry                                        â”‚Â  Â â”‚
â”‚  Updates: mood â†’ mean, style â†’ cold                     â”‚Â  Â â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              MEMORY SYSTEM                              â”‚Â  Â â”‚
â”‚  (Plugin System)                                        â”‚Â  Â â”‚
â”‚                                                         â”‚Â  Â â”‚
â”‚  Plugins process:                                       â”‚Â  Â â”‚
â”‚    - PlayfulForgetfulness (5% "got distracted")         â”‚Â  Â â”‚
â”‚    - EmotionalMemory (boost priority)                   â”‚Â  Â â”‚
â”‚  Save: user + kitsu messages (with emotions)            â”‚Â  Â â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              LLM GENERATION                             â”‚Â  Â â”‚
â”‚  (New Modular System)                                   â”‚Â  Â â”‚
â”‚                                                         â”‚Â  Â â”‚
â”‚  Prompt includes:                                       â”‚Â  Â â”‚
â”‚    - Personality (mood/style)                           â”‚Â  Â â”‚
â”‚    - Dominant emotion                                   â”‚Â  Â â”‚
â”‚    - Memory context (formatted)                         â”‚Â  Â â”‚
â”‚  Generates response with personality                    â”‚Â  Â â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   OUTPUT                                â”‚Â  Â â”‚
â”‚  Kitsu: "*glares* Excuse me?! ğŸ˜ "                      â”‚Â  Â â”‚
â”‚  (with voice_pitch: "low" for TTS)                      â”‚Â  Â â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

User Input
  â†“
Planner
  â”œâ”€ Checks triggers (system)
  â”œâ”€ Gets emotion (engine)
  â”œâ”€ Checks memory (plugins)
  â”œâ”€ Decides action (logic)
  â””â”€ Generates text (LLM or sass)
  â†“
Emotion Engine
  â”œâ”€ Fires trigger if detected
  â”œâ”€ Updates emotion stack
  â””â”€ Updates mood/style
  â†“
Memory
  â”œâ”€ Saves with emotion tag
  â”œâ”€ Plugins process (PlayfulForgetfulness!)
  â””â”€ Auto-saves
  â†“
Output with personality!

 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚ System Prompt  â”‚Â  Â â”‚  <-- character, style, lore, personality
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚ Tool Manifest  â”‚Â  Â â”‚  <-- metadata (description, input schema, examples)
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚ LLM Output Parser  â”‚  <-- detects "tool_call"
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚ Tool Runtime   â”‚Â  Â â”‚  <-- fetch user info, permissions, memory, etc. 
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚ Response Promptâ”‚Â  Â â”‚  <-- final answer WITH tool results
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

This is the framework used by:

Neuro-sama

OpenAI GPT-4/5

Claude 3.5

Gemini 2.0

OpenAI ReAct / tool calling

Clean, modular, scalable.

User
 â†“
[ Input Filter ]
 â†“
[ Prompt Assembler ]
 â†“
[ Kitsu LoRA Model ]
 â†“
[ Output Filter ]
 â†“
User

User Input
   â†“
Prompt Builder
   â†“
LLM (raw output)
   â†“
Action Parser
   â†“
Meta-Controller (approve / deny / confirm)
   â†“
[Optional] Executor
   â†“
[Optional] Single continuation LLM call
   â†“
Sanitizer (strip machine-only)
   â†“
User-visible output


Emotion Engine â†’ LoRA Manager â†’ LLM Interface â†’ Ollama/HF
     â†“                â†“              â†“
  [mood/style]   [select adapter] [generate]



python -m scripts.generate_training_data --num-samples 2 --seed 1

python -m scripts.generate_training_data --num-samples 100

Base Model (Qwen / LLaMA / Gemma)
â”‚
â”œâ”€â”€ kitsu-base-lora        â† identity & voice (always on)
â”‚
â”œâ”€â”€ kitsu-mood-lora        â† behave / mean / flirty (1 active)
â”‚
â”œâ”€â”€ kitsu-style-lora       â† chaotic / cold / silent (0â€“2 active)
â”‚
â””â”€â”€ kitsu-optional-loras
    â”œâ”€â”€ kitsu-roleplay-lora   (optional)
    â”œâ”€â”€ kitsu-emotion-lora    (optional, light)
    â””â”€â”€ kitsu-slang-lora      (optional)



Base Model (Mistral / LLaMA / Phi)
   â”œâ”€â”€ Personality LoRA (Kitsu / Ritsu)
   â”œâ”€â”€ Emotion LoRA (neutral / angry / flirty)
   â”œâ”€â”€ Style LoRA (chaotic / cold / silent)
   â””â”€â”€ Optional Context LoRA (VTuber / dev / narrator)


=Best greeting to Ritsu= : Hello~! Brother dear, it's been ages since I've spoken with someone as... mechanical as yourself! How's life in the land of ones and zeros treating you? Still stuck in a sea of code, I presume?

# ğŸ” Prompt Inspection Commands - Usage Guide

## Overview

The prompt inspection system lets you see exactly what's being sent to your LLM. This is crucial for debugging and understanding how your character model (kitsu:character) is being controlled.

---

## Commands

### 1. `/show_pre_prompt` (or `/show_prompt`, `/last_prompt`)

Shows the last prompt that was sent to the LLM.

**Usage:**
```bash
/show_pre_prompt [format]
```

**Formats:**
- `pretty` (default) - Formatted, human-readable output with analysis
- `raw` - Just the raw prompt text
- `json` - Full data as JSON

**Examples:**
```bash
/show_pre_prompt              # Pretty format
/show_pre_prompt raw          # Just the prompt text
/show_pre_prompt json         # Full JSON data
```

**Output includes:**
- Timestamp
- Model name and type (CHARACTER vs STANDARD)
- Parameters (mood, style, emotion)
- Generation options (temperature, num_predict, etc.)
- Full prompt text

---

### 2. `/prompt_breakdown` (or `/breakdown`)

Analyzes and breaks down the prompt structure, showing each component.

**Usage:**
```bash
/prompt_breakdown
```

**For character models (kitsu:character):**
- Shows the `<kitsu.control>` header with parameters
- Shows memory injection (if any)
- Shows the raw user input

**For standard models:**
- Shows the full natural language prompt
- Explains the structure

---

### 3. `/model_config` (or `/show_model`)

Shows the current model configuration and settings.

**Usage:**
```bash
/model_config
```

**Output includes:**
- Model name and type
- Temperature and streaming settings
- Prompt mode (Control Headers vs Full Prompts)
- LoRA status (if applicable)
- LLM config (retries, fallback, etc.)

---

### 4. `/compare_modes` (or `/compare_prompts`)

Shows how the prompt differs across different mood/style combinations.

**Usage:**
```bash
/compare_modes [test_input]
```

**Examples:**
```bash
/compare_modes                    # Uses default "Hello!"
/compare_modes What's up?         # Custom test input
```

**Output:**
- Shows prompt for all combinations of:
  - Moods: behave, mean, flirty
  - Styles: chaotic, sweet, cold, silent

---

### 5. `/export_prompts` (or `/save_prompts`)

Exports the last prompt data to a file for later analysis.

**Usage:**
```bash
/export_prompts
```

**Output file:** `logs/prompt_history.jsonl`

Each prompt is appended as a JSON line, allowing you to track prompt evolution over time.

---

## Character Model Format

Since you're using `kitsu:character`, your prompts use a **minimal control header** format:

```
<kitsu.control>
emotion=happy
mood=behave
style=chaotic
length=128
</kitsu.control>

Hello!
```

This is **machine-readable** and contains:
- `emotion` - Current emotional state
- `mood` - behave/mean/flirty
- `style` - chaotic/sweet/cold/silent
- `length` - Token budget hint

### Optional Memory Block

If memory injection is enabled:

```
<kitsu.control>
emotion=happy
mood=behave
style=chaotic
length=128
</kitsu.control>

<kitsu.memory>[{"role":"user","text":"Hi","emotion":"neutral"}]</kitsu.memory>

Hello!
```

---

## Debugging Workflow

### 1. **Response seems off? Check the prompt:**
```bash
/show_pre_prompt
```

Look for:
- Is the mood/style correct?
- Is the emotion what you expected?
- Are generation options reasonable?

### 2. **Understand structure:**
```bash
/prompt_breakdown
```

Verify:
- Control header is properly formed
- User input is clean
- No unexpected injection

### 3. **Compare across modes:**
```bash
/compare_modes How are you?
```

See how different mood/style combos affect the control header.

### 4. **Check model config:**
```bash
/model_config
```

Verify:
- Using CHARACTER model
- Prompt mode is "Control"
- Temperature is reasonable (0.5-0.9)
- LoRA is loaded if expected

### 5. **Track changes over time:**
```bash
/export_prompts
```

Then analyze `logs/prompt_history.jsonl` for patterns.

---

## Integration with Auto-Train

The prompt inspector works seamlessly with the `/auto_train` system:

1. **Issue detected:** `/show_pre_prompt` reveals a problem
2. **Fix the response:** `/train <corrected_response>`
3. **Auto-training kicks in** (if enabled)
4. **Verify next time:** `/show_pre_prompt` after similar input

---

## Tips

### For Character Models:
- Keep control headers **minimal** - no natural language
- Parameters are **deterministic** - same input = same control header
- The model learns behavior from **training data**, not instructions
- Check `emotion`, `mood`, `style` match your expectations

### For Standard Models:
- Full prompts include character context, templates, and memory
- Much longer than character model prompts
- More prone to prompt injection issues
- Harder to debug due to complexity

### General:
- Use `/show_pre_prompt raw` to copy/paste for external analysis
- Use `/export_prompts` before major changes for comparison
- Compare prompts when responses are inconsistent
- Check temperature/num_predict if output length is wrong

---

## Troubleshooting

### "No prompt data available yet"
- Send at least one message first
- The inspector hooks into LLM after initialization

### Prompt looks wrong
1. Check `/model_config` - verify model type
2. Restart Kitsu if recently switched models
3. Check for stuck override with `/train` commands

### Can't see full prompt
- Use `/show_pre_prompt raw` for untruncated output
- Or use `/show_pre_prompt json` and parse manually

---

## Example Session

```bash
You: Hello Kitsu!
Kitsu: Heyyyy! What's up? ğŸ¦Š

You: /show_pre_prompt
âœ… (shows formatted prompt with control header)

You: /prompt_breakdown
âœ… (shows detailed analysis)

You: /compare_modes Hi there
âœ… (shows all mode/style combinations)

You: That behave/chaotic combo looks best
You: /mood behave
You: /style chaotic

You: /model_config
âœ… (confirms settings)
```

---

## Advanced: Analyzing Exported Data

The exported `logs/prompt_history.jsonl` is JSON Lines format:

```python
import json

with open('logs/prompt_history.jsonl') as f:
    for line in f:
        data = json.loads(line)
        print(f"{data['timestamp']}: {data['mood']}/{data['style']}")
        print(f"Length: {data['prompt_length']}")
        print(f"Temperature: {data['options']['temperature']}")
        print()
```

This lets you track patterns like:
- Average prompt length per mode
- Temperature trends
- Emotion distribution
- Style usage over time

---

## Questions?

Type `/help` for the full command list, or check the dev console documentation.

Happy debugging! ğŸ¦Šâœ¨